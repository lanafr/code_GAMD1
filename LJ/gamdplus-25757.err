2023-11-07 18:57:55.775438: I external/xla/xla/service/service.cc:168] XLA service 0x8a18f00 initialized for platform Interpreter (this does not guarantee that XLA will be used). Devices:
2023-11-07 18:57:55.775489: I external/xla/xla/service/service.cc:176]   StreamExecutor device (0): Interpreter, <undefined>
2023-11-07 18:57:55.784024: I external/xla/xla/pjrt/tfrt_cpu_pjrt_client.cc:218] TfrtCpuClient created.
2023-11-07 18:57:56.218975: I external/xla/xla/service/service.cc:168] XLA service 0x89be6a0 initialized for platform CUDA (this does not guarantee that XLA will be used). Devices:
2023-11-07 18:57:56.219026: I external/xla/xla/service/service.cc:176]   StreamExecutor device (0): NVIDIA A40, Compute Capability 8.6
2023-11-07 18:57:56.219495: I external/xla/xla/pjrt/gpu/se_gpu_pjrt_client.cc:198] Using BFC allocator.
2023-11-07 18:57:56.219542: I external/xla/xla/pjrt/gpu/gpu_helpers.cc:105] XLA backend allocating 35730898944 bytes on device 0 for BFCAllocator.
2023-11-07 18:58:02.005661: I external/xla/xla/stream_executor/cuda/cuda_dnn.cc:424] Loaded cuDNN version 8500
2023-11-07 18:58:02.114149: I external/xla/xla/stream_executor/cuda/cuda_asm_compiler.cc:52] Using nvlink for parallel linking
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
Set SLURM handle signals.

  | Name | Type      | Params
-----------------------------------
0 | func | ODEFunc   | 147 K 
1 | ode  | NeuralODE | 147 K 
2 | fc   | Linear    | 129   
-----------------------------------
147 K     Trainable params
0         Non-trainable params
147 K     Total params
0.591     Total estimated model params size (MB)
WARNING:absl:Using a deprecated code path to create / update neighbor lists. It will be removed in a later version of JAX MD. Using `neighbor_fn.allocate` and `neighbor_fn.update` is preferred.
WARNING:absl:Using a deprecated code path to create / update neighbor lists. It will be removed in a later version of JAX MD. Using `neighbor_fn.allocate` and `neighbor_fn.update` is preferred.
Traceback (most recent call last):
  File "train_sequential_network_nice.py", line 107, in <module>
    main()
  File "train_sequential_network_nice.py", line 104, in main
    trainer.fit(model)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 458, in fit
    self._run(model)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 756, in _run
    self.dispatch()
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 797, in dispatch
    self.accelerator.start_training(self)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 96, in start_training
    self.training_type_plugin.start_training(trainer)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 144, in start_training
    self._results = trainer.run_stage()
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 807, in run_stage
    return self.run_train()
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/trainer/trainer.py", line 869, in run_train
    self.train_loop.run_training_epoch()
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/trainer/training_loop.py", line 490, in run_training_epoch
    batch_output = self.run_training_batch(batch, batch_idx, dataloader_idx)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/trainer/training_loop.py", line 731, in run_training_batch
    self.optimizer_step(optimizer, opt_idx, batch_idx, train_step_and_backward_closure)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/trainer/training_loop.py", line 424, in optimizer_step
    model_ref.optimizer_step(
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/core/lightning.py", line 1403, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 214, in step
    self.__optimizer_step(*args, closure=closure, profiler_name=profiler_name, **kwargs)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/core/optimizer.py", line 134, in __optimizer_step
    trainer.accelerator.optimizer_step(optimizer, self._optimizer_idx, lambda_closure=closure, **kwargs)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 329, in optimizer_step
    self.run_optimizer_step(optimizer, opt_idx, lambda_closure, **kwargs)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 336, in run_optimizer_step
    self.training_type_plugin.optimizer_step(optimizer, lambda_closure=lambda_closure, **kwargs)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 193, in optimizer_step
    optimizer.step(closure=lambda_closure, **kwargs)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/torch/optim/optimizer.py", line 140, in wrapper
    out = func(*args, **kwargs)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/torch/optim/optimizer.py", line 23, in _use_grad
    ret = func(self, *args, **kwargs)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/torch/optim/adam.py", line 183, in step
    loss = closure()
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/trainer/training_loop.py", line 725, in train_step_and_backward_closure
    result = self.training_step_and_backward(
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/trainer/training_loop.py", line 814, in training_step_and_backward
    result = self.training_step(split_batch, batch_idx, opt_idx, hiddens)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/trainer/training_loop.py", line 280, in training_step
    training_step_output = self.trainer.accelerator.training_step(args)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/accelerators/accelerator.py", line 204, in training_step
    return self.training_type_plugin.training_step(*args)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/pytorch_lightning/plugins/training_type/training_type_plugin.py", line 155, in training_step
    return self.lightning_module.training_step(*args, **kwargs)
  File "train_sequential_network_nice.py", line 83, in training_step
    y_pred = self(x.T)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "train_sequential_network_nice.py", line 71, in forward
    return self.fc(z[1])
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1194, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/guests/lana_frkin/GAMDplus/code/LJ/GAMDnew/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (66048x1 and 128x1)
2023-11-07 18:58:39.813920: I external/xla/xla/pjrt/tfrt_cpu_pjrt_client.cc:221] TfrtCpuClient destroyed.
